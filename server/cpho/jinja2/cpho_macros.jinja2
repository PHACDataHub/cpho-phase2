{% from 'generic_macros.jinja2' import date_display %}

{% macro indicator_data_table_w_submissions(data) %}
  {# assumes dimension_type and dimension_value are prefetched #}
  <table class="table">
    <thead>
      <tr>
        <th width=30%>{{ tdt("Stratifier value") }}</th>
        <th>{{ tdt("Indicator value") }}</th>
        <th>{{ tdt("Last modified") }}</th>
        <th>{{ tdt("Approval Status") }}</th>
      </tr>
    </thead>
    <tbody>
      {% for datum in data %}
        <tr>
          <th>
            {% if datum.dimension_type.is_literal %}
              {{ datum.literal_dimension_val }}
            {% else %}
              {{ datum.dimension_value.name }}
            {% endif %}
          </th>
          <td>{{ datum.value }}</td>
          <td>{{ date_display(datum.last_version_date) }}</td>
          <td>{{ submission_status_label(datum.submission_status) }}</td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
{% endmacro %}


{% macro submission_status_badge(submission_status) %}
  {% if submission_status == SUBMISSION_STATUSES.SUBMITTED %}
    {% set badge_type = "success" %}
  {% elif submission_status == SUBMISSION_STATUSES.NO_DATA %}
    {% set badge_type = "secondary" %}
  {% elif submission_status == SUBMISSION_STATUSES.PROGRAM_SUBMITTED %}
    {% set badge_type = "info" %}
  {% else %}
    {% set badge_type = "warning" %}
  {% endif %}
  <span class="badge bg-{{ badge_type }}">{{ submission_status_label(submission_status) }}</span>
{% endmacro %}
